# مولد مستندات RTL فارسی 📚

مخزنی برای تبدیل فایل‌های فارسی و تصاویر از مخزن `ehsan4232/translation` به فایل ورد با قالب‌بندی RTL صحیح.

## 🎯 ویژگی‌های کلیدی

✅ **قالب‌بندی RTL کامل** - پشتیبانی کامل از راست به چپ برای متن فارسی  
✅ **مدیریت محتوای ترکیبی** - کلمات و اعداد انگلیسی درون جملات فارسی RTL را خراب نمی‌کنند  
✅ **رفع مشکل علائم نگارشی** - پرانتز، براکت و علائم نگارشی در محیط RTL صحیح نمایش داده می‌شوند  
✅ **مرتب‌سازی طبیعی** - فایل‌ها به ترتیب طبیعی پردازش می‌شوند (1، 2، 3 نه 1، 10، 2)  
✅ **جاسازی تصاویر** - فایل‌های PNG/JPG به طور خودکار با اندازه مناسب جاسازی می‌شوند  
✅ **مدیریت خطا** - مدیریت مناسب فایل‌های خراب یا خالی  

## 📁 فایل‌های مخزن

### 📄 `comprehensive-system-design-rtl.md`
مستند جامع RTL با نمونه‌ای از اولین فایل‌های مخزن اصلی شما که شامل:
- فرمت‌بندی RTL صحیح برای متن فارسی
- نمایش تصاویر با لینک مستقیم از مخزن اصلی
- ساختار منظم و قابل خواندن

### 🐍 `generate_farsi_word_document.py`
اسکریپت پایتون کامل برای تولید فایل ورد که:
- از API GitHub برای دسترسی به فایل‌ها استفاده می‌کند
- تمام ۴۹۰+ فایل را پردازش می‌کند
- فایل ورد با قالب‌بندی RTL کامل تولید می‌کند

## 🚀 نحوه استفاده

### نیازمندی‌ها
```bash
pip install python-docx pillow requests
```

### مرحله ۱: دانلود اسکریپت
```bash
# کلون کردن این مخزن
git clone https://github.com/ehsan4232/farsi-rtl-documents.git
cd farsi-rtl-documents

# یا دانلود مستقیم اسکریپت
wget https://raw.githubusercontent.com/ehsan4232/farsi-rtl-documents/main/generate_farsi_word_document.py
```

### مرحله ۲: اجرای اسکریپت
```bash
python generate_farsi_word_document.py
```

### مرحله ۳: نتیجه
- فایل ورد در پوشه `output_documents` ایجاد می‌شود
- نام فایل: `translation_مستندات_طراحی_سیستم_RTL.docx`

## 📋 نمونه خروجی

```
🚀 مولد مستند ورد RTL فارسی
============================================================
📂 منبع: https://github.com/ehsan4232/translation

🔍 در حال دریافت فایل‌ها از مخزن GitHub: ehsan4232/translation
📁 490 فایل برای پردازش یافت شد
📄 در حال پردازش 1/490: 001.png
  🖼️  پردازش تصویر...
  ✅ تصویر با موفقیت اضافه شد
📄 در حال پردازش 2/490: 002.txt
  ✍️  پردازش متن فارسی...
  ✅ فایل متنی با موفقیت پردازش شد
...

🎉 مستند ورد با موفقیت ایجاد شد!
📁 ذخیره شده در: output_documents/translation_مستندات_طراحی_سیستم_RTL.docx
📊 490 فایل از مخزن GitHub پردازش شد

✨ ویژگی‌های مستند:
   ✓ قالب‌بندی RTL صحیح برای متن فارسی
   ✓ مدیریت صحیح کلمات انگلیسی درون جملات فارسی
   ✓ bullet point ها و شماره‌گذاری صحیح
   ✓ تمام تصاویر با اندازه مناسب
   ✓ مرتب‌سازی طبیعی فایل‌ها (1، 2، 3، ...)
   ✓ دانلود مستقیم از مخزن GitHub
```

## 🔧 جزئیات فنی

### چگونه RTL کار می‌کند؟

#### 1. تنظیم جهت سند
```python
# تنظیم جهت کل سند به RTL
section = doc.sections[0]
sectPr = section._sectPr
bidi = OxmlElement('w:bidi')
bidi.set(qn('w:val'), '1')
sectPr.append(bidi)
```

#### 2. تنظیم جهت پاراگراف
```python
def setup_rtl_paragraph(paragraph):
    pPr = paragraph._element.get_or_add_pPr()
    bidi = OxmlElement('w:bidi')
    bidi.set(qn('w:val'), '1')
    pPr.append(bidi)
    paragraph.alignment = WD_ALIGN_PARAGRAPH.RIGHT
```

#### 3. اصلاح متن برای RTL
```python
def fix_farsi_text(text):
    # اضافه کردن نشانه RTL
    if re.match(r'^[\u0600-\u06FF]', text.strip()):
        text = '\u200F' + text
    
    # مدیریت کلمات انگلیسی
    text = re.sub(r'([\u0600-\u06FF\s])([a-zA-Z0-9]+)([\u0600-\u06FF\s])', 
                  r'\1\u2060\2\u2060\3', text)
    
    # مدیریت علائم نگارشی
    text = text.replace('(', '\u200E(\u200F')
    text = text.replace(')', '\u200E)\u200F')
```

### فونت‌های پشتیبانی شده
1. **B Nazanin** (اولویت اول)
2. **Tahoma** (جایگزین)
3. **Arial** (پیش‌فرض)

## 📖 نمونه محتوا

### متن فارسی با RTL صحیح:
```
مقیاس‌دهی عمودی در مقابل مقیاس‌دهی افقی

مقیاس‌دهی عمودی، که به عنوان "scale up" شناخته می‌شود، به معنای اضافه کردن قدرت بیشتر (مانند CPU، RAM و غیره) به سرورهای شما است.
```

### Bullet Points با RTL:
```
• مقیاس‌دهی عمودی یک محدودیت سخت دارد
• اضافه کردن تعداد نامحدود CPU غیرممکن است
• مقیاس‌دهی عمودی دارای قابلیت failover نیست
```

## 🔍 عیب‌یابی

### مشکلات متداول:

#### خطای دانلود فایل
```python
# اگر خطای Rate Limit دریافت کردید:
sleep(0.1)  # توقف کوتاه بین درخواست‌ها
```

#### مشکل فونت
```python
# اگر فونت فارسی نصب نیست:
run.font.name = 'Tahoma'  # جایگزین
```

#### مشکل اندازه تصویر
```python
# کنترل اندازه تصاویر:
max_width = 6  # اینچ
img_width = min(max_width, width / 100)
```

## 📞 پشتیبانی

اگر مشکلی داشتید:
1. مطمئن شوید تمام کتابخانه‌ها نصب هستند
2. اتصال اینترنت خود را بررسی کنید
3. فونت‌های فارسی روی سیستم نصب کنید

## 📄 لایسنس

این پروژه تحت مجوز MIT منتشر شده است.

---

**نویسنده:** ehsan4232  
**مخزن اصلی:** [ehsan4232/translation](https://github.com/ehsan4232/translation)  
**تاریخ ایجاد:** ۱ اوت ۲۰۲۵  

---

### 🎯 نتیجه‌گیری

این ابزار به شما کمک می‌کند تا:
- تمام فایل‌های فارسی خود را با فرمت RTL صحیح در یک فایل ورد جمع‌آوری کنید
- مشکلات قالب‌بندی متن فارسی در محیط‌های مختلف را حل کنید
- مستندات حرفه‌ای با ترکیب متن و تصویر ایجاد کنید

**نکته مهم:** این اسکریپت تمام ۴۹۰ فایل شما را پردازش می‌کند و فایل ورد کاملی با قالب‌بندی RTL تولید می‌کند که برای چاپ، ارسال و استفاده حرفه‌ای مناسب است.
